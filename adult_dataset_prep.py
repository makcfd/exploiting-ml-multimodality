import pandas as pd
from sklearn.model_selection import train_test_split

df = pd.read_csv("/exploiting_model_multiplicity/data/original/adult.csv")
df.drop_duplicates(inplace=True)
df.drop(['fnlwgt'], axis=1, inplace=True)
df.drop(['education'], axis=1, inplace=True)

df_ml = pd.get_dummies(df,  drop_first=True)
features = df_ml.drop(['income_>50K'], axis=1)
target = df_ml['income_>50K']
X_train, X_test, Y_train, Y_test = train_test_split(features, target, train_size=0.8, test_size=0.2, random_state=42, shuffle=False)
X_train.to_csv("data/adult_dataset/train/X.csv", index=True)
Y_train.to_csv("data/adult_dataset/train/Y.csv", index=True)
X_test.to_csv("data/adult_dataset/test/X.csv", index=True)
Y_test.to_csv("data/adult_dataset/test/Y.csv", index=True)