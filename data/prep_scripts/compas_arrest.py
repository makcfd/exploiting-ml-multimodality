import os
import pandas as pd
from sklearn.model_selection import train_test_split

df = pd.read_csv(
    "/exploiting_model_multiplicity/data/original/compas_arrest_processed.csv"
)
features = df.drop(["arrest"], axis=1)
target = df["arrest"]
# target value -1 converting into 0 so that target represents classic binary classification
target = target.replace(-1, 0)
X_train, X_test, Y_train, Y_test = train_test_split(
    features, target, train_size=0.8, test_size=0.2, random_state=42, shuffle=False
)
paths_to_save = ["../compas_arrest/train/", "../compas_arrest/test/"]
for path in paths_to_save:
    if not os.path.exists(path):
        os.makedirs(path)
X_train.to_csv("../compas_arrest/train/X.csv", index=True)
Y_train.to_csv("../compas_arrest/train/Y.csv", index=True)
X_test.to_csv("../compas_arrest/test/X.csv", index=True)
Y_test.to_csv("../compas_arrest/test/Y.csv", index=True)
